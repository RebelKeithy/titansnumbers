<!-- comment to force github to rebuild page -->

<html>
	<head>
		<title>Tap Titans Optimizer</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
		<script src="http://rebelkeithy.github.io/titansnumbers/jcookies/jquery.cookie.js"></script>
		<script>
			var amuletDamage = 0;
			var bossMultiplier = [2, 4, 6, 7, 10];
			var skillAtLevel = [10, 25, 50, 100, 200, 400, 800];

			var heroImageIndex = [
				{x:0, y:1},
				{x:0, y:2},
				{x:0, y:4},
				{x:0, y:3},
				{x:4, y:1},
				{x:2, y:1},
				{x:0, y:5},
				{x:5, y:1},
				{x:3, y:1},
				{x:0, y:0},
				{x:4, y:5},
				{x:4, y:2},
				{x:2, y:3},
				{x:4, y:4},
				{x:5, y:2},
				{x:5, y:0},
				{x:5, y:4},
				{x:2, y:2},
				{x:4, y:0},
				{x:1, y:1},
				{x:5, y:3},
				{x:1, y:2},
				{x:3, y:3},
				{x:5, y:5},
				{x:4, y:3},
				{x:3, y:2},
				{x:3, y:4},
				{x:3, y:5},
				{x:1, y:3},
				{x:3, y:0}
			]
			var amuletImageIndex = {
				valrunes: {x:3, y:3},
				resolution: {x:0, y:3},
				mettle: {x:1, y:6},
				savior: {x:3, y:4},
				contentment: {x: 0, y:6},
				elixir: {x: 3, y: 5},
				egg: {x: 1, y: 3},
				cloak: {x:0, y:4},
				seeker: {x:2, y:4},
				chalice: {x:1, y:7},
				hammer: {x:2, y:6},
				fortune: {x:0, y:0},
				ointment: {x: 1, y:0},
				thrust: {x:2, y:5},
				pendant: {x:1, y:2},
				gauntlet: {x:2, y:2},
				armor: {x:3, y:7},
				lotion: {x:2, y:3},
				parchment: {x:2, y:7},
				opulence: {x:3, y:0},
				charm: {x:1, y:5},
				scroll: {x:3, y:6},
				saintly: {x:0, y:2},
				tincture: {x:0, y:1},
				fissure: {x:2, y:1},
				aura: {x:0, y:5},
				revival: {x:0, y:7},
				worldly: {x:1, y:4},
				shield: {x:3, y:2}
			}
			var stageValues = {
				stage: 1,
				mobHealth: 30,
				mobGold: 1,
				bossHealth: 60,
				bossGold: 1,
				chestChance: 0.02,
				chestGold: 10
			}
			var gameValues = {
				heroLevel: 1,
				heroNextLevelCost: 1,
				criticalDamage: 1,
				criticalMultiplier: 10,
				criticalChance: 0.01,
				tapDamage: 1,
				tapDPS: 7,
				heroDamage: 0,
				upgradeSets: 0,
				heavenlyStrike: 0,
				shadowClone: 0,
				criticalStrike: 0,
				warCry: 0,
				handOfMidas: 0
			}
			var heroSkills = {
				heroDamage: 0,
				allDamage: 0,
				tapDamage: 0,
				bossDamage: 0,
				criticalDamage: 0,
				criticalChance: 0,
				goldAmount: 0,
				chestGold: 0,
				tapDPS: 0
			}

			var skillTranslation = {
				heroDamage: "Increase this hero's damage by ",
				allDamage: "Increase ALL damage by ",
				criticalDamage: "Increase critical damage by ",
				bossDamage: "Increase all damage on Boss by ",
				tapDamage: "Increase this tap damage by ",
				tapDPS: "Increase tap damage by total DPS ",
				criticalChance: "Increase critical chance by ",
				goldAmount: "Increase gold dropped amount by ",
				chestGold: "Increase treasure chest gold by "
			}
			
			// dps field is never used and should be remove
			var heros = [
				{name:"Takeda the Blade Assassin", level:"0", upgrades:"0", dps:4, cost:"50", skillType:["heroDamage", "heroDamage", "allDamage", "criticalDamage", "heroDamage", "allDamage", "heroDamage"], skillValue:[0.5, 1, 0.1, 0.1, 10, 0.25, 100], skillBought:[false, false, false, false, false, false, false]},
				{name:"Contessa the Torch Wielder", level:"0", upgrades:"0", dps:16, cost:"175", skillType:["tapDamage", "heroDamage", "heroDamage", "tapDPS", "allDamage", "goldAmount", "heroDamage"], skillValue:[0.05, 1, 10, 0.004, 0.1, 0.1, 100], skillBought:[false, false, false, false, false, false, false]},
				{name:"Hornetta, Queen of the Valrunes", level:"0", upgrades:"0", dps:56, cost:"674", skillType:["heroDamage", "goldAmount", "allDamage", "tapDPS", "chestGold", "criticalChance", "allDamage"], skillValue:[1.5, 0.1, 0.1, 0.004, 0.2, 0.01, 0.3], skillBought:[false, false, false, false, false, false, false]},
				{name:"Mila the Hammer Stomper", level:"0", upgrades:"0", dps:188, cost:"2.58E+3", skillType:["heroDamage", "heroDamage", "goldAmount", "heroDamage", "criticalDamage", "allDamage", "chestGold"], skillValue:[1, 8, 0.06, 5, 0.05, 0.2, 0.2], skillBought:[false, false, false, false, false, false, false]},
				{name:"Terra the Land Scorcher", level:"0", upgrades:"0", dps:807, cost:"13.3E+3", skillType:["heroDamage", "goldAmount", "tapDPS", "goldAmount", "chestGold", "tapDamage", "heroDamage"], skillValue:[3, 0.1, 0.004, 0.15, 0.2, 0.05, 100], skillBought:[false, false, false, false, false, false, false]},
				{name:"Inquisireaux the Terrible", level:"0", upgrades:"0", dps:3.29E+3, cost:"68.1E+3", skillType:["heroDamage", "heroDamage", "allDamage", "allDamage", "criticalDamage", "criticalChance", "heroDamage"], skillValue:[2, 7, 0.1, 0.2, 0.05, 0.02, 100], skillBought:[false, false, false, false, false, false, false]},
				{name:"Charlotte the Special", level:"0", upgrades:"0", dps:14.14E+3, cost:"384E+3", skillType:["heroDamage", "bossDamage", "bossDamage", "heroDamage", "tapDamage", "chestGold", "allDamage"], skillValue:[2, 0.05, 0.07, 6, 0.05, 0.2, 0.3], skillBought:[false, false, false, false, false, false, false]},
				{name:"Jordaan, Knight of Mini", level:"0", upgrades:"0", dps:63.64E+3, cost:"2.36E+6", skillType:["heroDamage", "allDamage", "tapDPS", "goldAmount", "chestGold", "heroDamage", "allDamage"], skillValue:[2, 0.1, 0.004, 0.15, 0.2, 19, 0.2], skillBought:[false, false, false, false, false, false, false]},
				{name:"Jukka, Master of Axes", level:"0", upgrades:"0", dps:440.12E+3, cost:"23.8E+6", skillType:["heroDamage", "bossDamage", "allDamage", "criticalDamage", "heroDamage", "allDamage", "heroDamage"], skillValue:[1.5, 0.05, 0.3, 0.05, 50, 0.25, 100], skillBought:[false, false, false, false, false, false, false]},
				{name:"Milo and Clonk-Clonk", level:"0", upgrades:"0", dps:1.74E+6, cost:"143E+6", skillType:["heroDamage", "criticalChance", "bossDamage", "goldAmount", "chestGold", "chestGold", "allDamage"], skillValue:[1.5, 0.01, 0.05, 0.15, 0.2, 0.25, 0.15], skillBought:[false, false, false, false, false, false, false]},
				{name:"Macelord the Ruthless", level:"0", upgrades:"0", dps:7.15E+6, cost:"943E+6", skillType:["heroDamage", "heroDamage", "tapDamage", "tapDPS", "goldAmount", "criticalChance", "heroDamage"], skillValue:[2, 8.5, 0.05, 0.004, 0.15, 0.01, 38], skillBought:[false, false, false, false, false, false, false]},
				{name:"Gertrude the Goat Rider", level:"0", upgrades:"0", dps:30.65E+6, cost:"6.84E+9", skillType:["heroDamage", "heroDamage", "bossDamage", "criticalDamage", "tapDPS", "tapDamage", "goldAmount"], skillValue:[2.5, 13, 0.07, 0.05, 0.004, 0.05, 0.2], skillBought:[false, false, false, false, false, false, false]},
				{name:"Twitterella the Tweeter", level:"0", upgrades:"0", dps:136.87E+6, cost:"54.7E+9", skillType:["heroDamage", "heroDamage", "tapDamage", "allDamage", "allDamage", "criticalDamage", "heroDamage"], skillValue:[1.5, 8.5, 0.05, 0.2, 0.3, 0.05, 120], skillBought:[false, false, false, false, false, false, false]},
				{name:"Master Hawk, Lord of Luft", level:"0", upgrades:"0", dps:1.08E+9, cost:"820E+9", skillType:["heroDamage", "heroDamage", "tapDPS", "heroDamage", "goldAmount", "criticalDamage", "goldAmount"], skillValue:[2, 11, 0.004, 4, 0.1, 0.1, 0.2], skillBought:[false, false, false, false, false, false, false]},
				{name:"Elpha, Wielder of Gems", level:"0", upgrades:"0", dps:5.35E+9, cost:"8.2E+12", skillType:["heroDamage", "allDamage", "bossDamage", "criticalChance", "criticalDamage", "chestGold", "heroDamage"], skillValue:[3, 0.4, 0.05, 0.02, 0.15, 0.2, 100], skillBought:[false, false, false, false, false, false, false]},
				{name:"Poppy, Daughter of Ceremony", level:"0", upgrades:"0", dps:76.51E+9, cost:"164E+12", skillType:["heroDamage", "chestGold", "goldAmount", "bossDamage", "bossDamage", "allDamage", "allDamage"], skillValue:[3.5, 0.25, 0.2, 0.05, 0.07, 0.15, 0.2], skillBought:[false, false, false, false, false, false, false]},
				{name:"Skulptor, Protector of Bridges", level:"0", upgrades:"0", dps:547.07E+9, cost:"1.64E+15", skillType:["heroDamage", "heroDamage", "goldAmount", "goldAmount", "tapDamage", "criticalDamage", "goldAmount"], skillValue:[1.5, 9, 0.1, 0.1, 0.05, 0.1, 0.25], skillBought:[false, false, false, false, false, false, false]},
				{name:"Sterling the Enchantor", level:"0", upgrades:"0", dps:391.16E+9, cost:"49.2E+15", skillType:["heroDamage", "heroDamage", "bossDamage", "heroDamage", "tapDamage", "chestGold", "allDamage"], skillValue:[4, 5, 0.05, 4.5, 0.05, 0.2, 0.15], skillBought:[false, false, false, false, false, false, false]},
				{name:"Orba the Foreseer", level:"0", upgrades:"0", dps:391.16E+9, cost:"2.46E+18", skillType:["heroDamage", "heroDamage", "tapDPS", "tapDamage", "allDamage", "goldAmount", "allDamage"], skillValue:[2, 10, 0.005, 0.05, 0.1, 0.1, 0.1], skillBought:[false, false, false, false, false, false, false]},
				{name:"Remus the Noble Archer", level:"0", upgrades:"0", dps:391.16E+9, cost:"73.8E+18", skillType:["heroDamage", "heroDamage", "criticalDamage", "heroDamage", "tapDPS", "tapDamage", "goldAmount"], skillValue:[2.5, 6, 0.2, 4.5, 0.004, 0.1, 0.1], skillBought:[false, false, false, false, false, false, false]},
				{name:"Mikey the Magician Apprentice", level:"0", upgrades:"0", dps:391.16E+9, cost:"2.44E+21", skillType:["heroDamage", "tapDamage", "allDamage", "criticalChance", "allDamage", "chestGold", "heroDamage"], skillValue:[2, 0.05, 0.3, 0.02, 0.1, 0.2, 100], skillBought:[false, false, false, false, false, false, false]},
				{name:"Peter Pricker the Prickly Poker", level:"0", upgrades:"0", dps:391.16E+9, cost:"244E+21", skillType:["heroDamage", "heroDamage", "allDamage", "heroDamage", "allDamage", "criticalGold", "allDamage"], skillValue:[2.5, 7.5, 0.1, 5, 0.1, 0.3, 0.2], skillBought:[false, false, false, false, false, false, false]},
				{name:"Teeny Tom, Keeper of the Castle", level:"0", upgrades:"0", dps:391.16E+9, cost:"48.7E+24", skillType:["heroDamage", "heroDamage", "tapDPS", "criticalDamage", "tapDamage", "criticalChance", "heroDamage"], skillValue:[3, 8, 0.004, 0.2, 0.1, 0.02, 100], skillBought:[false, false, false, false, false, false, false]},
				{name:"Denzis the Cleanser", level:"0", upgrades:"0", dps:391.16E+9, cost:"19.5E+27", skillType:["heroDamage", "heroDamage", "heroDamage", "goldAmount", "chestGold", "heroDamage", "allDamage"], skillValue:[2, 5, 12, 0.15, 0.2, 90, 0.15], skillBought:[false, false, false, false, false, false, false]},
				{name:"Hamlette, Painter of Skulls", level:"0", upgrades:"0", dps:391.16E+9, cost:"21.4E+30", skillType:["tapDamage", "tapDamage", "tapDPS", "allDamage", "goldAmount", "criticalChance", "heroDamage"], skillValue:[0.05, 0.05, 0.004, 0.1, 0.15, 0.02, 150], skillBought:[false, false, false, false, false, false, false]},
				{name:"Eistor the Banisher", level:"0", upgrades:"0", dps:391.16E+9, cost:"2.36E+36", skillType:["heroDamage", "heroDamage", "tapDPS", "bossDamage", "allDamage", "bossDamage", "goldAmount"], skillValue:[3.5, 6.5, 0.004, 0.5, 0.1, 0.05, 0.12], skillBought:[false, false, false, false, false, false, false]},
				{name:"Flavius and Oinksbjorn", level:"0", upgrades:"0", dps:391.16E+9, cost:"25.9E+45", skillType:["heroDamage", "heroDamage", "allDamage", "bossDamage", "criticalChance", "criticalDamage", "chestGold"], skillValue:[3, 7, 0.1, 0.1, 0.02, 0.3, 0.2], skillBought:[false, false, false, false, false, false, false]},
				{name:"Chester the Beast Tamer", level:"0", upgrades:"0", dps:391.16E+9, cost:"28.5E+60", skillType:["heroDamage", "allDamage", "heroDamage", "heroDamage", "criticalDamage", "criticalChance", "allDamage"], skillValue:[3.5, 0.01, 4, 6, 0.2, 0.03, 0.15], skillBought:[false, false, false, false, false, false, false]},
				{name:"Mohacas the Wind Warrior", level:"0", upgrades:"0", dps:391.16E+9, cost:"3.14E+81", skillType:["heroDamage", "heroDamage", "goldAmount", "tapDamage", "goldAmount", "allDamage", "goldAmount"], skillValue:[3.3, 5.5, 0.1, 0.1, 0.2, 0.1, 0.3], skillBought:[false, false, false, false, false, false, false]},
				{name:"Jaqulin the Unknown", level:"0", upgrades:"0", dps:391.16E+9, cost:"3.76E+111", skillType:["criticalDamage", "tapDamage", "tapDPS", "goldAmound", "allDamage", "allDamage", "allDamage"], skillValue:[0.4, 0.2, 0.01, 0.6, 0.2, 0.3, 0.4], skillBought:[false, false, false, false, false, false, false]}
			];
			var amulets = {
				"savior": {name:"Savior Shield", level:"0", maxLevel:25, baseDamage:0.3, incrementDamage:0.15, costX:0.5, costY:1.7},
				"fissure": {name:"Universal Fissure", level:"0", maxLevel:-1, baseDamage:1.2, incrementDamage:0.6, costX:0.5, costY:1.7},
				"tincture": {name:"Tincture of the Maker", level:"0", maxLevel:-1, baseDamage:0.1, incrementDamage:0.05, costX:0.6, costY:2.5},
				"valrunes": {name:"Amulet of the Valrunes", level:"0", maxLevel:-1, baseDamage:0.5, incrementDamage:0.25, costX:0.7, costY:2}, // Implemented
				"hammer": {name:"Drunken Hammer", level:"0", maxLevel:-1, baseDamage:0.4, incrementDamage:0.2, costX:0.5, costY:1.7},
				"chalice": {name:"Divine Chalice", level:"0", maxLevel:-1, baseDamage:0.3, incrementDamage:0.15, costX:0.7, costY:1.7},
				"pendant": {name:"Laborer's Pendant", level:"0", maxLevel:10, baseDamage:0.7, incrementDamage:0.35, costX:0.7, costY:1.5},
				"seeker": {name:"Death Seeker", level:"0", maxLevel:25, baseDamage:0.3, incrementDamage:0.15, costX:0.5, costY:2, costX:0.5, costY:2},
				"thrust": {name:"Hero's Thrust", level:"0", maxLevel:-1, baseDamage:0.3, incrementDamage:0.15, costX:0.7, costY:1.7},
				"fortune": {name:"Future's Fortune", level:"0", maxLevel:-1, baseDamage:0.3, incrementDamage:0.15, costX:0.7, costY:2},
				"opulence": {name:"Ring of Opulence", level:"0", maxLevel:-1, baseDamage:0.7, incrementDamage:0.35, costX:0.7, costY:1.7},
				"mettle": {name:"Barbarian's Mettle", level:"0", maxLevel:10, baseDamage:0.7, incrementDamage:0.35, costX:0.4, costY:1.5},
				"lotion": {name:"Overseer's Lotion", level:"0", maxLevel:10, baseDamage:0.7, incrementDamage:0.35, costX:0.4, costY:1.5},
				"elixir": {name:"Crafter's Elixir", level:"0", maxLevel:-1, baseDamage:0.4, incrementDamage:0.2, costX:0.5, costY:1.8},	// implemented
				"resolution": {name:"Axe of Resolution", level:"0", maxLevel: -1, baseDamage:0.7, incrementDamage:0.35, costX:0.5, costY:1.7},
				"aura": {name:"Undead Aura", level:"0", maxLevel:-1, baseDamage:0.3, incrementDamage:0.15, costX:0.7, costY:2},
				"egg": {name:"Crown Egg", level:"0", maxLevel:-1, baseDamage:0.4, incrementDamage:0.2, costX:1, costY:1.5},	// implemented 
				"parchment": {name:"Parchment of Importance", level:"0", maxLevel:-1, baseDamage:0.7, incrementDamage:0.35, costX:0.5, costY:1.7},
				"cloak": {name:"Dark Cloak of Life", level:"0", maxLevel:25, baseDamage:0.3, incrementDamage:0.15, costX:0.5, costY:2, costX:0.5, costY:2},
				"shield": {name:"Knight's Shield", level:"0", maxLevel:-1, baseDamage:0.6, incrementDamage:0.3, costX:0.7, costY:1.5},

				"contentment": {name:"Chest of Contentment", level:"0", maxLevel:-1, baseDamage:0.4, incrementDamage:0.2, costX:1, costY:1.5},  // implemented
				"ointment": {name:"Hunter's Ointment", level:"0", maxLevel:10, baseDamage:1.2, incrementDamage:0.6, costX:0.4, costY:1.5},
				"gauntlet": {name:"Ogre's Gauntlet", level:"0", maxLevel:-1, baseDamage:0.7, incrementDamage:0.35, costX:0.5, costY:1.7},
				"armor": {name:"Otherworldly Armor", level:"0", maxLevel:-1, baseDamage:0.7, incrementDamage:0.35, costX:1, costY:2.2},
				"charm": {name:"Ring of Wonderous Charm", level:"0", maxLevel:25, baseDamage:0.3, incrementDamage:0.15, costX:0.5, costY:1.7},
				"scroll": {name:"Sacred Scroll", level:"0", maxLevel:10, baseDamage:0.7, incrementDamage:0.35, costX:0.4, costY:1.5},
				"saintly": {name:"Saintly Shield", level:"0", maxLevel:10, baseDamage:0.7, incrementDamage:0.35, costX:0.3, costY:1.5},
				"revival": {name:"Warrior's Revival", level:"0", maxLevel:-1, baseDamage:0.7, incrementDamage:0.35, costX:1, costY:2.2},
				"worldly": {name:"Worldly Illuminator", level:"0", maxLevel:5, baseDamage:3, incrementDamage:1.5, costX:0.6, costY:3}
			};

			function loadGameFromString()
			{
				var saveString = prompt("Enter your save string.");

				loadFromString(window.atob(saveString));
			}

			function saveGameToString()
			{
				var saveString = getSaveString();

				window.prompt("Here is the save string", window.btoa(saveString));
			}

			function getSaveString()
			{
				var saveString = "1"; //saveVersion

				saveString += "|" + stageValues.stage;
				saveString += "|" + gameValues.heroLevel;

				for(var i = 0; i < heros.length; i++)
				{
					saveString += "|" + heros[i].level + "!";

					for(var j = 0; j < 7; j++)
					{
						if(heros[i].skillBought[j])
							saveString += "1";
						else
							saveString += "0";
					}

					saveString += "!" + heros[i].upgrades;
				}

				for(var name in amulets)
				{
					saveString += "|" + name + "|" + amulets[name].level;
				}

				return saveString;
			}

			function loadFromString(saveString)
			{
				var splitSaveString = saveString.split("|");

				stageValues.stage = splitSaveString[1];
				gameValues.heroLevel = splitSaveString[2];
				$("#stage").val(stageValues.stage);

				for(var i = 0; i < heros.length; i++)
				{
					var heroString = splitSaveString[3 + i].split("!");
					heros[i].level = heroString[0];

					if(heros[i].level > 0)
						$("#hero" + i).val(heros[i].level);
					else
						$("#hero" + i).val(0);

					for(var j = 0; j < 7; j++)
					{
						if(heroString[1].charAt(j) == "1")
						{
							$("#hero" + i + "skill" + j).prop('checked', true);
							heros[i].skillBought[j] = true;
						}
						else
						{
							$("#hero" + i + "skill" + j).prop('checked', false);
							heros[i].skillBought[j] = false;
						}
					}

					if(heroString[2] > 0)
						heros[i].upgrades = heroString[2];
					else
						heros[i].upgrades = 0;

					$("#hero" + i + "upgrades").val(heros[i].upgrades);
				}

				for(var i = 0; i < 29; i++)
				{
					var amuletName = splitSaveString[33 + i * 2];
					var level = splitSaveString[34 + i * 2];
					if(level > 0)
					{
						amulets[amuletName].level = level;
						$("#" + amuletName).val(level);
					}
				}

			}

			function saveCookie()
			{
				for(var i = 0; i < heros.length; i++)
				{
					var cookie = heros[i].level + "!";

					for(var j = 0; j < 7; j++)
					{
						if(heros[i].skillBought[j])
							cookie += "1";
						else
							cookie += "0";
					}
					cookie += "!" + heros[i].upgrades;
					$.cookie("hero" + i, cookie);
				}

				for(var name in amulets)
				{
					$.cookie("amulet" + name, amulets[name].level);
				}

				$.cookie("stage", stageValues.stage);
				$.cookie("heroLevel", gameValues.heroLevel);
			}

			function loadCookie()
			{
				for(var i = 0; i < heros.length; i++)
				{
					var cookie = $.cookie("hero" + i).split("!");
					heros[i].level = cookie[0];

					if(heros[i].level > 0)
						$("#hero" + i).val(heros[i].level);
					else
						$("#hero" + i).val(0);

					for(var j = 0; j < 7; j++)
					{
						if(cookie[1].charAt(j) == "1")
						{
							$("#hero" + i + "skill" + j).prop('checked', true);
							heros[i].skillBought[j] = true;
						}
						else
						{
							$("#hero" + i + "skill" + j).prop('checked', false);
							heros[i].skillBought[j] = false;
						}
					}
					if(cookie[2] > 0)
						heros[i].upgrades = cookie[2];
					else
						heros[i].upgrades = 0;
					$("#hero" + i + "upgrades").val(heros[i].upgrades);
				}

				for(var name in amulets)
				{
					var level = $.cookie("amulet" + name);
					if(level > 0)
					{
						amulets[name].level = level;
						$("#" + name).val(level);
					}
				}

				stageValues.stage = $.cookie("stage");
				$("#stage").val(stageValues.stage);
				gameValues.heroLevel = $.cookie("heroLevel");
				$("#taphero").val(gameValues.heroLevel);
			}
		</script>
	</head>
	<body>
	<script>loadCookie()</script>
	<h2><p id="r2" style="text-align:center; padding-top:10px; font-weight:bold; font-size:150%; font-family: sans-serif; color:#FFFFFF; text-shadow: 2px 2px 2px #555555;">Tap Titans Optimizer</p></h2>
	<table align="center">
		<tr>
			<td valign="top">
				<table cellspacing="0" class="titanstext" style="margin-right:10px">
					<tr class="greenRow">
						<td>Stage:</td>
						<td id="tstage"><input class="titanstext" type="number" id="stage" style="width:70px; background-color:#78BC87" value="1" onkeyup="updateTitans()" onchange="updateTitans()"/></td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="greenRow">
						<td>Hero Level:</td>
						<td id="therolevel"><input class="titanstext" type="number" id="taphero" style="width:70px; background-color:#78BC87" value="1" onkeyup="updateTitans()" onchange="updateTitans()"/></td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="greenRow">
						<td>Hero DPS:</td>
						<td id="therodps">0</td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="greenRow">
						<td>Tap Damage:</td>
						<td id="ttapdamage">1</td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="greenRow">
						<td>Critical Damage:</td>
						<td id="tcriticaldamage">10</td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="greenRow">
						<td>Critical Chance:</td>
						<td id="tcriticalchance">1%</td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="greenRow">
						<td>Total DPS (10 tps):</td>
						<td id="ttotaldps">10</td>
					</tr>
				</table>
			</td>
			<td valign="top">
				<table cellspacing="0" class="titanstext" >
					<tr class="goldRow">
						<td>Mob Gold:</td>
						<td id="tmobgold">1</td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="goldRow">
						<td>Chest Gold:</td>
						<td id="tchestgold">10</td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="goldRow">
						<td>Chest Chance:</td>
						<td id="tchestchance">2%</td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="goldRow">
						<td>Boss Gold:</td>
						<td id="tbossgold">2</td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="goldRow">
						<td>Stage Gold:</td>
						<td id="tstagegold">12</td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="spacing"></tr>
					<tr class="redRow">
						<td>Mob Health:</td>
						<td id="tmobhealth">30</td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="redRow">
						<td>Boss Health</td>
						<td id="tbosshealth">60</td>
					</tr>
					<tr class="spacing"></tr>
					<tr class="redRow">
						<td>Seconds to kill Boss</td>
						<td id="tsecondstokillboss">10</td>
					</td>
				</table>
			</td>
		</tr>
	</table>

	<style>
		.redRow > td:first-of-type
		{
			background-image: url("images/redRowLeft.png");
			background-repeat: no-repeat;
			background-size: 100% 100%;
			display:inline-block;
			padding-left: 10px;
			height:45px;
			width: 160px;
		}
		.redRow > td:last-of-type
		{
			background-image: url("images/redRowRight.png");
			background-repeat: no-repeat;
			background-size: 100% 100%;
			display:inline-block;
			text-align: right;
			padding-right: 10px;
			height:45px;
			width: 100px;
		}
		.greenRow > td:first-of-type
		{
			background-image: url("images/greenRowLeft.png");
			background-repeat: no-repeat;
			background-size: 100% 100%;
			display:inline-block;
			padding-left: 10px;
			height:45px;
			width: 160px;
		}
		.greenRow > td:last-of-type
		{
			background-image: url("images/greenRowRight.png");
			background-repeat: no-repeat;
			background-size: 100% 100%;
			display:inline-block;
			text-align: right;
			padding-right: 10px;
			height:45px;
			width: 100px;
		}
		.goldRow > td:first-of-type
		{
			background-image: url("images/goldRowLeft.png");
			background-repeat: no-repeat;
			background-size: 100% 100%;
			display:inline-block;
			padding-left: 10px;
			height:45px;
			width: 160px;
		}
		.goldRow > td:last-of-type
		{
			background-image: url("images/goldRowRight.png");
			background-repeat: no-repeat;
			background-size: 100% 100%;
			display:inline-block;
			text-align: right;
			padding-right: 10px;
			height:45px;
			width: 100px;
		}
		.damagecell
		{
			height: 45;
			width: 300;
			margin: 0 0 -45px 0;
			background: url("images/goldRow.png");
			background-size: 100% 100%;
   			padding:0;
		}
	</style>

	<div id="tabs-container" style="padding-top:25px">

	<input id="load" type="button" value="Load" onclick="loadGameFromString()"/>
	<input id="save" type="button" value="Save" onclick="saveGameToString()"/>
    <div id="topbar"><div id="therodpsbar" style="display:inline" >Hero DPS: 0</div>
    <div style="display:inline;padding-left:30px">Tap DPS:</div><div style="display:inline" id="ttapdps">0</div>
    <div style="display:inline;padding-left:30px">Artifact Multiplier:</div><div style="display:inline" id="tartifcatmultiplier">0%</div></div>
    <div class="tab" style="background-color:#000000" align="center">
        <div id="tab-2" class="tab-content">

			<div style="height:400px;overflow:auto;background-color:#161616">
				<table cellspacing="0" id="artifacts" style="padding-left: 6px">
					<script>
						for(var key in amulets)
						{
							document.write("<tr class=\"spacing\"></tr>");
							document.write("<tr class=\"artifactRow\" style=\"height:92px; padding-right:20px\">");
							document.write("<td align=\"center\" style=\"padding-left:7px; padding-top:3px\"><div class=\"artifactimage\" style=\"background: url(images/artifacts.png) " + amuletImageIndex[key].x * 64 + " " + amuletImageIndex[key].y * 64 + "/256px 512px\"></div></td>");
							document.write("<td><table style=\"width:275\">");
							document.write("<tr><td class=\"titanstext\">" + amulets[key].name + "</td></tr>");
							document.write("<tr><td class=\"titanstext\" id=\"" + key + "bonus\">+0%</td></tr>");
							document.write("<tr><td class=\"titanstext\" id=\"" + key + "damage\">+0% All Damage</td></tr>");
							document.write("</table></td>");
							document.write("<td style=\"padding-right:20px\"><table style=\"width:200\">");
							document.write("<tr><td class=\"titanstext\" style=\"padding-right: 0px; text-align: right\">Lv.<input class=\"titanstext\" style=\"width: 50px; margin-left:6px; background-color:#555555; border:2px solid #CCCCCC\" type=\"number\" id=\"" + key + "\" value=\"0\" onchange=\"updateArtifacts()\"></td></tr>");
							document.write("<tr><td class=\"titanstext\" style=\"text-align: right\">Next Level <img src=\"images\\relic.png\" height=\"11\" width=\"13\"> <div id=\"" + key + "nextlevel\" style=\"display: inline-block\">0</div></td></tr>");
							document.write("<tr><td class=\"titanstext\" style=\"text-align: right\">Total Spent <img src=\"images\\relic.png\" height=\"11\" width=\"13\"> <div id=\"" + key + "totalspent\"  style=\"display: inline-block\">0</td></tr>");
							document.write("</table></td>");
							document.write("</tr>");
						}
					</script>
					<td><input type="button" value="Reset Artifacts" onclick="resetArtifacts()">	
				</table><br>
			</div>
		</div>
        <div id="tab-1" class="tab-content">

			<div style="height:400px;overflow:auto;background-color:#161616">
				<table cellspacing="0" id="heros" style="padding-left: 6px">
					<script>
						document.write("<tr class=\"spacing\"></tr>");
						for(var i = 0; i < heros.length; i++)
						{
							document.write("<tr class=\"heroRow\" style=\"height:92px;\">");
							document.write("<td align=\"center\" style=\"padding-left:7px; padding-top:5px\"><div class=\"heroimage\" style=\"background: url(images/heros.png) " + heroImageIndex[i].x * 60 + " " + heroImageIndex[i].y * 60  + "/360px 360px\"></div></td>");
							document.write("<td>");
							document.write("<table>");
							document.write("<tr class=\"titanstext\"><td colspan=\"3\">" + heros[i].name + "</td></tr>");
							document.write("<tr class=\"titanstext\"><td><div style=\"display: inline-block\">Lv. </div><input class=\"titanstext\" class=\"heroLevel\" style=\"margin-left: 6px; background-color:#555555; border:2px solid #CCCCCC; width: 50px;\" type=\"number\" id=\"hero" + i + "\" onchange=\"updateHeroLevel(" + i + ")\"></td>")
							document.write("<td style=\"padding-left: 12px\">Weapon Upgrades <input class=\"titanstext\" style=\"background-color:#555555; width: 40px;\" type=\"number\" id=\"hero" + i + "upgrades\" onchange=\"updateHeroUpgrades(" + i + ")\"></td>")
							document.write("</tr><tr class=\"titanstext\"><td colspan=\"2\">Skills ");
							for(var j = 0; j < 7; j++)
							{
								document.write("<input class=\"heroSkill\", type=\"checkbox\" heroID=\"" + i + "\" id=\"hero" + i + "skill" + j + "\" title=\"" + skillTranslation[heros[i].skillType[j]] + 100*heros[i].skillValue[j] + "%\" onchange=\"updateSkillChecks(" + i + ", " + j + ")\">");
							}
							document.write("<td><div id=\"hero" + i + "skilltooltip\" style=\"display: inline-block; font-size: 65%\"></div></td></td></tr>")
							document.write("</table>")
							document.write("<td style=\"padding-right:20px\"><table style=\"width:200\">");
							document.write("<tr><td class=\"titanstext\" id=\"hero" + i + "dps\" style=\"text-align: right\">Hero DPS: </td></tr>");
							document.write("<tr><td class=\"titanstext\" style=\"text-align: right\">Next Level <img src=\"images\\gold.png\" height=\"11\" width=\"11\" style=\"padding-right: 2px\"><div id=\"hero" + i + "cost\" style=\"display: inline-block\">0</div></td></tr>");
							document.write("<tr><td class=\"titanstext\" style=\"text-align: right\">Total Spent <img src=\"images\\gold.png\" height=\"11\" width=\"11\" style=\"padding-right: 2px\"><div id=\"hero" + i + "totalcost\" style=\"display: inline-block\">0</div></td></tr>");
							document.write("</table></td>")
							document.write("</tr>");
							document.write("<tr class=\"spacing\"></tr>");
						}
					</script>
					<td><input type="button" value="Reset Heros" onclick="resetHeros()">	
				</table>
		    </div>
		</div>
	</div>
	<!--<input id="maxstage" type="button" value="Maximize" onclick="findMaxStage()" />-->
    <div align="center" style="height:49px;background-color:#000000" class="tabs-menu" padding="10">
		<div class="current" id="btnherotab" href="#tab-1"></div>
		<div id="btnartifactstab" href="#tab-2"></div>
	</div>
	<style>
		#topbar
		{
			height: 30px;
			background-image: url("images/topBar.png");
			background-size: contain;
    		font-family: "Times New Roman", Times, serif;
    		font-weight: bold;
    		font-size: 110%;
    		padding-left: 10px;
    		padding-top: 15px;
    		color: white;
    		text-align: center
		}
		#btnherotab
		{
			margin-left: 10px;
			width: 149;
			height: 49;
			background-image: url("images/herosUp.png");
			display: inline-block
		}
		#btnherotab.current
		{
			margin-left: 10px;
			width: 149;
			height: 49;
			background-image: url("images/herosDown.png");
			display: inline-block
		}
		#btnartifactstab
		{
			margin-left: 10px;
			width: 149;
			height: 49;
			background-image: url("images/artifactsUp.png");
			display: inline-block
		}
		#btnartifactstab.current
		{
			margin-left: 10px;
			width: 149;
			height: 49;
			background-image: url("images/artifactsDown.png");
			display: inline-block
		}
		.scrolltable
		{
			height: 150px;
			overflow: scroll;
		}
		.spacing
		{
			height: 12px;
		}
		.heroRow > td:first-of-type
		{
			background-image: url("images/heroRowLeft.png");
			background-repeat: no-repeat;
			background-size: 100% 100%;
			display:inline-block;
			width: 82px;
		}
		.heroRow > td
		{
			background-image: url("images/heroRowMid2.png");
			background-repeat: none;
			background-size: 100% 100%;
    		font-family: "Times New Roman", Times, serif;
    		font-style: bold;
    		color: white;
		}
		.heroRow > td:last-of-type
		{
			width: 200px;
			text-align:right;
			background-image: url("images/heroRowRight.png");
    		background-position: right; 
			background-repeat: no-repeat;
			background-size: cover;
		}
		.artifactRow > td:first-of-type
		{
			background-image: url("images/heroRowLeft.png");
			background-repeat: no-repeat;
			background-size: 100% 100%;
			display:inline-block;
			width: 82px;
		}
		.artifactRow > td
		{
			background-image: url("images/heroRowMid2.png");
			background-repeat: none;
			background-size: 100% 100%;
    		font-family: "Times New Roman", Times, serif;
    		font-style: bold;
    		color: white;
		}
		.artifactRow > td:last-of-type
		{
			background-image: url("images/heroRowRight.png");
    		background-position: right; 
			background-repeat: no-repeat;
			background-size: cover;
		}
		.artifactimage
		{
			width:64;
			height:64;
		    margin-left: auto;
		    margin-right: auto;
		}
		.heroimage
		{
			width:60;
			height:60;
		}
		.titanstext
		{
    		font-family: "Arial", Arial, serif;
    		font-weight: bold;
    		color: white;
		}
		#tab-2-fade
		{
  			background:#000;
    		opacity: 1;
   			transition: opacity 1s ease-in-out;
		}
		body {
			background: url('images/background.png');
			margin: 0px;
			padding: 0px;
			border-left: 150px;
			border-right: 150px;
			border-bottom: 0px;
			border-top: 0px;
			overflow-x: hidden; /* For Opera */
    		border-image: url('images/border.png') 50 50 round;
		}
	</style>
	<script>
		loadCookie();
	</script>
</body>
</html>

<style>
	.tab-content {
	    display: none;
	}

	#tab-1 {
	 display: block;   
	}
</style>

<script>
	$(document).ready(function() {
		updateHeroLevel();
		updateArtifacts();
		
		$(".heroSkill_").hover(function() {
		    var heroID = $(this).attr("heroID");
		    setText("hero" + heroID + "skilltooltip", $(this).attr("title"));
		    }, function(){
		    var heroID = $(this).attr("heroID");
		    setText("hero" + heroID + "skilltooltip", "");
		});

		$(".tabs-menu div").click(function(event) {
			console.log("click");
	        event.preventDefault();
	        $(this).addClass("current");
	        $(this).siblings().removeClass("current");
	        var tab = $(this).attr("href");
	        $(".tab-content").not(tab).css("display", "none");
	        $(tab).fadeIn();
	    });
	});
</script>

<script>
	function findMaxStage()
	{

		var stage = 1;
		for(stage = 160; stage < 2000; stage += 5)
		{
			var sumBaseGold = 18.5 * (6.37E+30 + 3.63E+30 * (Math.pow(1.17, stage-156) - 1)/0.17);
			sumBaseGold *= (0.02 + (0.00045 * 150));
			
			var chestChance = 0.02 * (1 + 0.2 * amulets["egg"].level);
			var totalMobGold = 10 * (1 - chestChance) * sumBaseGold * Math.ceil(1 + heroSkills["goldAmount"] + 0.05 * amulets["fortune"].level) * (1 + (0.1 * amulets["valrunes"].level)) * (1 + (0.15 * amulets["elixir"].level));
			var totalBossGold = 5.8 * sumBaseGold * Math.ceil(1 + heroSkills["goldAmount"] + 0.05 * amulets["fortune"].level) * (1 + 1 * amulets["shield"].level) * (1 + (0.15 * amulets["elixir"].level));
			var totalChestGold = chestChance * 10 * sumBaseGold * Math.ceil(1 + heroSkills["goldAmount"] + 0.05 * amulets["fortune"].level)  * (1 + heroSkills["chestGold"]) * (1 + (0.4 * amulets["contentment"].level)) * (1 + (0.15 * amulets["elixir"].level));
			var sumTotalGold = totalMobGold + totalBossGold + totalChestGold;
			console.log("Total gold " + stage + ": " + formatNumber(sumTotalGold));

			var maxHeroId
			for(var i = heros.length - 1; i > 20; i--)
			{
				if(heros[i].cost < sumTotalGold)
				{
					maxHeroId = i;
					break;
				}
			}

			var heroLevel = Math.floor(Math.log(sumTotalGold*(0.075/heros[maxHeroId].cost) + 1)/Math.log(1.075));
			var dps = heroDPS(maxHeroId + 1, heroLevel) * (1 + +(amuletDamage));
			console.log("Hero:" + heros[maxHeroId].name + " Level: " + heroLevel);
			
			var heroMultiplier = 0;
			for(var i = 0; i < 7; i++)
			{
				if(heroLevel < skillAtLevel[i])
					break;

				if(heros[maxHeroId].skillType[i] == "heroDamage");
					heroMultiplier += heros[maxHeroId].skillValue[i];
			}

			dps *= 1 + +(heroMultiplier);

			var tapDamage = (dps * heroSkills["tapDPS"]) * (1 + heroSkills["tapDamage"]) * (1 + amuletDamage) * (1 + 0.1*amulets["hammer"].level);
			var criticalMultiplier = (10 + +(heroSkills["criticalDamage"])) * (1 + 0.2*amulets["thrust"].level);
			var criticalDamage = tapDamage * criticalMultiplier * 0.65;
			var criticalChance = 0.01 + heroSkills["criticalChance"] + 0.02 * amulets["seeker"].level;
			var tapDPS = (1-criticalChance) * tapDamage + criticalChance * criticalDamage;
			tapDPS *= 10; //Taps per second
			var totalDPS = dps + tapDPS;
			console.log("DPS:" + formatNumber(totalDPS));

			var baseHealth = 18.5 * Math.pow(1.57, 156) * Math.pow(1.17, stage - 156);
			var bossHealth = baseHealth * 10 * (1 - 0.02 * amulets["cloak"].level);


			var bossTime = bossHealth/totalDPS;
			console.log("Boss Health: " + formatNumber(bossHealth));
			console.log("Time to kill Boss: " + bossTime);
			if(bossTime > 6.0)
				break;
		}

		alert("You should be able to reach stage " + stage + "\n\n(Note: this does not yet take into account evolving heros)")
	}

	function updateSkillChecks(hero, skill)
	{
		var skillEnabled = $("#hero" + hero + "skill" + skill).prop('checked');
		heros[hero].skillBought[skill] = skillEnabled;

		if(skillEnabled)
		{
			if(heros[hero].level < skillAtLevel[skill])
			{
				heros[hero].level = skillAtLevel[skill];
				$("#hero" + hero).val(skillAtLevel[skill]);
			}
			for(var i = 0; i < skill; i++)
			{
				$("#hero" + hero + "skill" + i).prop('checked', true);
				heros[hero].skillBought[i] = true;
			}
		}
		else
		{
			for(var i = skill + 1; i < 7; i++)
			{
				$("#hero" + hero + "skill" + i).prop('checked', false);
				heros[hero].skillBought[i] = false;
			}
		}

		updateHeroLevel();
	}

	function heroDPS(heroID, level)
	{
		var baseCost = heros[heroID-1].cost;
		var evolved = level > 1000;

		var A = baseCost * (evolved ? 10 : 1) * Math.pow(1.075, level - 1);
		var B = Math.pow(1.075, evolved ? level - 1000 : level) - 1;
		var C = Math.pow(0.904, evolved ? level - 1001 : level - 1) * Math.pow(1 - (0.019 * (evolved ? 15 : Math.min(heroID, 15))), heroID + (evolved ? 30 : 0));

		return A * B * C / 0.75;

		//(((HeroBaseCost * 10 * 1.075(level-1) * (1.075^(Level - 1000) - 1.0) / 0.075) * (0.904^(level - 1001) * (1f - (0.019 * 15))^heroID + 30)) * 0.1) 

		//return baseCost * (evolved ? 10 : 1) * A * B * C * 0.1/0.075;

		//return baseCost * (evolved ? 10 : 1) * Math.pow(1.075, level-1) * (Math.pow(1.075,(evolved ? level - 1000 : level)) - 1)  * (Math.pow(0.904, level-(evolved ? 1001 : 1)) * (Math.pow(1 - (0.019 * (Math.min(heroID, 15))), heroID) + (evolved ? 30 : 0))) / (0.075) * 0.1;
	}

	function updateHeroUpgrades(heroID)
	{
		var upgrades = $("#hero" + heroID + "upgrades").val();

		heros[heroID].upgrades = +(upgrades);

		var minUpgrades = upgrades;
		for(var i = 0; i < heros.length; i++)
		{
			minUpgrades = Math.min(minUpgrades, heros[i].upgrades);
		}
		gameValues.upgradeSets = minUpgrades;

		updateTitans();
	}

	function getTotalHeroSpent(heroID)
	{
		return heros[heroID].cost * (1 - Math.pow(1.075, heros[heroID].level))/(1- 1.075);
	}

	function getHeroCost(heroID, level)
	{
		return heros[heroID].cost * Math.pow(1.075, level - 1);
	}

	function updateHeroLevel()
	{
		heroSkills = {
				heroDamage: 0,
				allDamage: 0,
				tapDamage: 0,
				bossDamage: 0,
				criticalDamage: 0,
				criticalChance: 0,
				goldAmount: 0,
				chestGold: 0,
				tapDPS: 0
			};
		for(var i = 0; i < heros.length; i++)
		{
			var hlabel = "#hero" + i;
			heros[i].level = $(hlabel).val();

			var nextCost = getHeroCost(i, +(heros[i].level) + 1);
			for(var j = 0; j < 7; j++)
			{
				var skillEnabled = $(hlabel + "skill" + j).prop('checked');

				if(heros[i].skillBought[j])
				{
					heroSkills[heros[i].skillType[j]] += heros[i].skillValue[j];
				}
			}
			setText("hero" + i + "cost", formatNumber(nextCost));
			setText("hero" + i + "totalcost", formatNumber(getTotalHeroSpent(i)));
		}

		updateTitans();
	}

	function resetHeros()
	{
		for(var i = 0; i < heros.length; i++)
		{
			var hlabel = "#hero" + i;
			heros[i].level = 0;
			$(hlabel).val(0);
			
			for(var j = 0; j < 7; j++)
			{
				var skillEnabled = $(hlabel + "skill" + j).prop('checked', false);
				heros[i].skillBought[j] = false;
				heroSkills[heros[i].skillType[j]] = 0;
			}
		}
		
		updateTitans();
	}

	function updateStage()
	{
		stageValues.stage = $("#stage").val();
		if(stageValues.stage > 4000)
			stageValues.stage = 4000;

		var baseHealth = 18.5 * Math.pow(1.57, Math.min(stageValues.stage, 156)) * Math.pow(1.17, Math.max(stageValues.stage - 156, 0));
		var baseGold = baseHealth * (0.02 + (0.00045 * Math.min(stageValues.stage, 150)));

		stageValues.bossHealth = baseHealth * bossMultiplier[(stageValues.stage-1)%5] * (1 - 0.02 * amulets["cloak"].level);
		stageValues.mobHealth = baseHealth;
		stageValues.mobGold = baseGold * Math.ceil(1 + heroSkills["goldAmount"] + 0.05 * amulets["fortune"].level) * (1 + (0.1 * amulets["valrunes"].level)) * (1 + (0.15 * amulets["elixir"].level));
		stageValues.bossGold = baseGold * bossMultiplier[(stageValues.stage-1)%5] * Math.ceil(1 + heroSkills["goldAmount"] + 0.05 * amulets["fortune"].level) * (1 + 1 * amulets["shield"].level) * (1 + (0.15 * amulets["elixir"].level));
		stageValues.chestGold = 10 * baseGold * Math.ceil(1 + heroSkills["goldAmount"] + 0.05 * amulets["fortune"].level)  * (1 + heroSkills["chestGold"]) * (1 + (0.4 * amulets["contentment"].level)) * (1 + (0.15 * amulets["elixir"].level));
		stageValues.chestChance = 0.02 * (1 + 0.2 * amulets["egg"].level);
		
	}

	function getArtifactBonus(artifact)
	{
		return 0;
	}

	function artifactCost(artifact, level)
	{
		return Math.round(amulets[artifact].costX * Math.pow(+(level)+1, amulets[artifact].costY));
	}

	function totalSpentOnArtifact(artifact)
	{
		var spent = 0;
		for(var i = 0; i < amulets[artifact].level; i++)
		{
			spent += artifactCost(artifact, i);
		}

		return spent;
	}

	function artifactBonusString(name)
	{
		if(name == "savior")
		{
			return "+" + 10 * amulets[name].level + "% Boss Time";
		}
		if(name == "fissure")
			return "+" + 10 * amulets[name].level + "% War Cry Duration";
		if(name == "tincture")
			return "+" + 5 * amulets[name].level + "% DPS";
		if(name == "valrunes")
			return "+" + 10 * amulets[name].level + "% Monster Gold";
		if(name == "hammer")
			return "+" + 10 * amulets[name].level + "% Tap Damage";
		if(name == "chalice")
			return "+" + 0.5 * amulets[name].level + "% Chance for 10x Gold";
		if(name == "pendant")
			return "-" + 5 * amulets[name].level + "% Hand of Midas Cool Down";
		if(name == "seeker")
			return "+" + 2 * amulets[name].level + "% Critical Chance";
		if(name == "thrust")
			return "+" + 20 * amulets[name].level + "% Critical Damage";
		if(name == "fortune")
			return "+" + 5 * amulets[name].level + "% Gold Collection";
		if(name == "opulence")
			return "+" + 10 * amulets[name].level + "% Hand of Midas Duration";
		if(name == "mettle")
			return "-" + 5 * amulets[name].level + "% Berserker Rage Cool Down";
		if(name == "lotion")
			return "-" + 5 * amulets[name].level + "% Shadow Clone Cool Down";
		if(name == "elixir")
			return "+" + 15 * amulets[name].level + "% Gold While Playing";
		if(name == "resolution")
			return "+" + 10 * amulets[name].level + "% Berserker Rage Duration";
		if(name == "aura")
			return "+" + 5 * amulets[name].level + "% Bonus Relic from Prestige";
		if(name == "egg")
			return "+" + 20 * amulets[name].level + "% Treasure Box Chance";
		if(name == "parchment")
			return "+" + 10 * amulets[name].level + "% Critical Strike Duration";
		if(name == "cloak")
			return "-" + 2 * amulets[name].level + "% Boss Life";
		if(name == "shield")
			return "+" + 100 * amulets[name].level + "% Boss Gold";
		if(name == "contentment")
			return "+" + 20 * amulets[name].level + "% Gold Treasure Box Chance";
		if(name == "ointment")
			return "-" + 5 * amulets[name].level + "% War Cry Cool Down";
		if(name == "gauntlet")
			return "+" + 10 * amulets[name].level + "% Shadow Clone Duration";
		if(name == "charm")
			return "-" + 2 * amulets[name].level + "% Upgrade Cost";
		if(name == "scroll")
			return "-" + 5 * amulets[name].level + "% Critical Strike Cool Down";
		if(name == "saintly")
			return "-" + 5 * amulets[name].level + "% Heavenly Strike Cool Down";
		if(name == "revival")
			return "-" + 5 * amulets[name].level + "% Revive Time";
		if(name == "worldly")
			return "-" + 100 * amulets[name].level + "% Monsters Each Stage";
		if(name == "armor")
			return "-" + 5 * amulets[name].level + "% Hero Death Chance";

		return "+0%";
	}

	function updateArtifacts(name)
	{
		amuletDamage = 0;
		for(var key in amulets)
		{
			amulets[key].level = $("#" + key).val();
			if(amulets[key].level > amulets[key].maxLevel && amulets[key].maxLevel != -1)
			{
				amulets[key].level = amulets[key].maxLevel;
				$("#" + key).val(amulets[key].maxLevel);
			}
		}

		for(var key in amulets)
		{
			if(amulets[key].level > 0)
			{
				var currDamage = amulets[key].incrementDamage * (1 + +(amulets[key].level)) * (1 + 0.05 * amulets["tincture"].level);
				amuletDamage += currDamage;
				setText(key + "bonus", artifactBonusString(key));
				setText(key + "damage", "+" + Math.round(currDamage*100) + "% All Damage");
				
				setText(key + "nextlevel", formatNumber(artifactCost(key, amulets[key].level)));
				setText(key + "totalspent", formatNumber(totalSpentOnArtifact(key)));
				//alert($("#" + key + "damage"))
			}
			else
			{
				setText(key + "bonus", artifactBonusString(key));
				setText(key + "damage", "+0% All Damage");

				setText(key + "nextlevel", "N/A");
				setText(key + "totalspent", "0");
			}
		}
		
		updateTitans();
	}

	function resetArtifacts()
	{
		amuletDamage = 0;
		for(var key in amulets)
		{
			amulets[key].level = 0;
			$("#" + key).val(0);
			setText(key + "damage", "0%");
		}

		updateTitans();
	}
	
	function updateTitans()
	{	

		gameValues.heroDamage = 0;
		for(var i = 0; i < heros.length; i++)
		{
			var heroDamage = heroDPS(i+1, heros[i].level);
			var heroMultiplier = 0;

			if(heroSkills["allDamage"] > 0)
			{
				heroMultiplier += heroSkills["allDamage"];
			}
			for(var j = 0; j < 7; j++)
			{
				var hlabel = "#hero" + i;
				var skillEnabled = $(hlabel + "skill" + j).prop('checked');
				if(skillEnabled)
				{
					if(heros[i].skillType[j] == 'heroDamage')
					{
						heroMultiplier += heros[i].skillValue[j];
					}
				}
			}

			heroDamage *= 1 + heroMultiplier;
			heroDamage *= 1 + 0.5 * heros[i].upgrades;
			if(+(gameValues.upgradeSets) > 0)
				heroDamage *= 10 * gameValues.upgradeSets;
			heroDamage *= 1 + amuletDamage;
			gameValues.heroDamage += heroDamage;

			gameValues.heroLevel = $("#taphero").val();

			setText("hero" + i + "dps", "DPS: " + formatNumber(heroDamage));
		}	

		updateStage();
		
		gameValues.tapDamage = (gameValues.heroLevel * Math.pow(1.05, gameValues.heroLevel) * (1 + heroSkills["allDamage"]) + gameValues.heroDamage * heroSkills["tapDPS"]) * (1 + heroSkills["tapDamage"]) * (1 + amuletDamage) * (1 + 0.1*amulets["hammer"].level);
		gameValues.criticalMultiplier = (10 + +(heroSkills["criticalDamage"])) * (1 + 0.2*amulets["thrust"].level);
		gameValues.criticalDamage = gameValues.tapDamage * gameValues.criticalMultiplier * 0.65;
		gameValues.criticalChance = 0.01 + heroSkills["criticalChance"] + 0.02 * amulets["seeker"].level;
		gameValues.tapDPS = (1-gameValues.criticalChance) * gameValues.tapDamage + gameValues.criticalChance * gameValues.criticalDamage
		gameValues.tapDPS *= 9; //Taps per second

		updateText();
		saveCookie();
	}

	function updateText()
	{
		var stageGold = 10 * stageValues.chestChance * stageValues.chestGold + 10 * (1 - stageValues.chestChance) * stageValues.mobGold + stageValues.bossGold;

		//if(heroSkills["goldAmount"] > 0)
		//	setText("tgoldmultiplier", "Gold Multiplier: " + Math.round(heroSkills["goldAmount"]*100) + "%");
		setText("tmobhealth", formatNumber(stageValues.mobHealth));
		setText("tbosshealth", formatNumber(stageValues.bossHealth));
		setText("tmobgold", formatNumber(stageValues.mobGold));
		setText("tbossgold", formatNumber(stageValues.bossGold));
		setText("tchestchance", Math.round(100*stageValues.chestChance) + "%");
		setText("tchestgold", formatNumber(stageValues.chestGold));
		setText("tstagegold", formatNumber(stageGold));
		setText("tartifcatmultiplier", Math.round(amuletDamage * 100) + "%");
		//setText("talldamage", "Hero All Damage: " + Math.round(heroSkills["allDamage"] * 100) + "%");
		setText("therodps", formatNumber(gameValues.heroDamage));
		setText("therodpsbar", "Hero DPS:" + formatNumber(gameValues.heroDamage));
		setText("ttapdamage", formatNumber(gameValues.tapDamage));
		//setText("tcriticalmultiplier", "Critical Multiplier: " + gameValues.criticalMultiplier.toFixed(2));
		setText("tcriticaldamage", formatNumber(gameValues.criticalDamage));
		setText("tcriticalchance", Math.round(gameValues.criticalChance*100) + "%");
		setText("ttapdps", formatNumber(gameValues.tapDPS));
		setText("tsecondstokillboss", formatNumber(stageValues.bossHealth / ((gameValues.tapDPS + gameValues.heroDamage) * (1 + +(heroSkills["bossDamage"])))));
	}
	
	function setText(name, text)
	{
		element = document.getElementById(name);
		element.innerHTML = text;
	}
	
	function formatNumber(num)
	{
		var count = 0;
		while(num >= 1000)
		{
			num /= 1000;
			count++;
		}
		num = +(num).toFixed(2);
		
		var exp = "+E" + count*3;
		if(count < 31)
		{
			if(count == 0) {
				exp = "";
			} else if(count == 1) {
				exp = "K";
			} else if(count == 2) {
				exp = "M";
			} else if(count == 3) {
				exp = "B";
			} else if(count == 4) {
				exp = "T";
			} else {
				exp = String.fromCharCode(97 + count - 5) + String.fromCharCode(97 + count - 5);
			}
		}
		
		return num + exp
	}
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-60309918-1', 'auto');
  ga('send', 'pageview');

</script>